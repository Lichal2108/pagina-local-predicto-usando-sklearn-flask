<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inteligencia de Negocios - Predictor de Cáncer de Mama</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <!-- Header Principal -->
    <header class="main-header">
        <div class="header-content">
            <h1 class="main-title">Inteligencia de Negocios</h1>
            <h2 class="subtitle">Predictor de Cáncer de Mama</h2>
            <p class="header-description">Sistema de Predicción Inteligente para Diagnóstico Médico</p>
        </div>
    </header>

    <div class="container">
        {% if logo_path %}
        <div class="logo">
            <img src="{{ logo_path }}" alt="Hospital Logo">
        </div>
        {% endif %}
        
        <!-- Sección de Información -->
        <div class="info-section">
            <h3>¿Qué es este sistema?</h3>
            <p>Este predictor utiliza algoritmos de Machine Learning para analizar datos clínicos y predecir la probabilidad de que un tumor sea benigno o maligno, ayudando a los profesionales médicos en la toma de decisiones clínicas.</p>
            
            <div class="features">
                <h4>Características del Sistema:</h4>
                <ul>
                    <li>✅ Análisis basado en múltiples variables clínicas</li>
                    <li>✅ Predicción con alta precisión</li>
                    <li>✅ Interfaz intuitiva y fácil de usar</li>
                    <li>✅ Resultados en tiempo real</li>
                    <li>✅ Recomendaciones personalizadas</li>
                </ul>
            </div>
        </div>

        <h3 class="form-title">Predicción de Cáncer de Mama</h3>
        <p class="desc">Ingrese los valores clínicos para predecir si el tumor es <b>benigno</b> o <b>maligno</b>. Presentación para Inteligencia de Negocios.</p>
        
        <form method="post" class="formulario" id="formulario-prediccion">
            <div class="inputs">
                <div class="input-group" style="flex-basis:100%;">
                    <label for="id_paciente_selector">Cargar datos de paciente:</label>
                    <select id="id_paciente_selector">
                        <option value="">-- Seleccione un paciente --</option>
                        {% for pid, label in id_pacientes %}
                        <option value="{{ pid }}">{{ label }}</option>
                        {% endfor %}
                    </select>
                    <button type="button" id="btn-cargar-paciente">Cargar datos</button>
                </div>
                {% for col in input_columns %}
                <div class="input-group">
                    <label for="{{ col }}">{{ col.replace('_', ' ').title() }}</label>
                    <input type="number" step="any" name="{{ col }}" id="{{ col }}" value="{{ values[col] }}" required>
                </div>
                {% endfor %}
            </div>
            <button type="submit">Predecir</button>
        </form>
        
        <script>
        document.getElementById('btn-cargar-paciente').onclick = function() {
            var id = document.getElementById('id_paciente_selector').value;
            if (!id) return;
            fetch('/get_paciente/' + id)
                .then(response => response.json())
                .then(data => {
                    for (const [key, value] of Object.entries(data)) {
                        var input = document.getElementById(key);
                        if (input) input.value = value;
                    }
                });
        };
        </script>
        
        {% if resultado %}
        <div class="resultado">
            <h2>Diagnóstico: <span class="diagnostico {{ resultado|lower }}">{{ resultado }}</span></h2>
            <div class="probs">
                <h3>Probabilidades:</h3>
                <ul>
                    {% for clase, proba in probabilidades.items() %}
                    <li><b>{{ clase }}:</b> {{ '%.2f'|format(proba*100) }}%</li>
                    {% endfor %}
                </ul>
            </div>
            <div class="confianza">
                <b>Confianza:</b> {{ confianza }}
            </div>
            {% if recomendacion %}
            <div class="recomendacion">{{ recomendacion }}</div>
            {% endif %}
        </div>
        {% endif %}
        
        {% if error %}
        <div class="error">Error: {{ error }}</div>
        {% endif %}
        
        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <p><strong>Inteligencia de Negocios</strong> - Sistema de Predicción Médica</p>
                <p>Desarrollado con Machine Learning y Flask</p>
                <p class="disclaimer">Este sistema es una herramienta de apoyo y no reemplaza el diagnóstico médico profesional.</p>
            </div>
        </footer>
    </div>
</body>
</html> 